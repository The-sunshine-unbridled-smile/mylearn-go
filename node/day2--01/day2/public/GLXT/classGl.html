<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="bootstrap-3.3.7-dist/css/bootstrap.css" type="text/css">
    <link rel="stylesheet" href="css/clsMsg.css" type="text/css">
</head>
<body>
<section class="container">
    <div class="content">
        <div class="select">
                        <form class="form-inline">
                            <label>班级编号</label>
                        <input type="text" class="claNo">
                        <label>班级名称</label>
                        <input type="text" class="claName">
                        <label>项目经理</label>
                        <input type="text" class="proMan">
                        <label>班主任</label>
                        <input type="text" class="claTea">
                            <input type="button" class="Search" value="查询">
                    </form>
                 </div>
        <a href="classXz.html" class="addClassbtn">新增班级</a>
        <div style="clear: both"></div>
        <!--表格-->
        <table class="table">
            <thead>
            <tr>
                <td>班级编号</td>
                <td>班级名称</td>
                <td>班级课程编号</td>
                <td>班级教室</td>
                <td>开班日期</td>
                <td>创建时间</td>
                <td>班级状态</td>
                <td>QQ群号</td>
                <td>备注</td>
                <td>操作</td>
            </tr>
            </thead>
        <tbody>
        </tbody>
        </table>
    </div>

</section>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.params.js"></script>
<script type="text/javascript">
    var request = new XMLHttpRequest();
    request.open("get", "roleMan.do", true);
    request.onreadystatechange = function () {
        if (request.readyState == 4 && request.status == 200) {
            var data = JSON.parse(request.responseText);
            arr(data);
        }
    };
    request.send(null);

    //页面显示数据
    function arr(data) {
        var role = -1;
        for (var i = 0; i < data.length; i++) {
            var str = '<tr class="interline">' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td class="line"></td>' +
                '<td><button type="button" class="revise">修改</button>' +
                '<button type="button" class="del">删除</button>' +
                '</td>' +
                '</tr>';
            if (data.length > 1) {
                $("#tbody").append(str);
            } else {
                $("#tbody").html(str);
            }
            $.each(data[i], function (key) {
                role++;
                $(".line")[role].innerText = data[i][key];
            })
        }
    }


    //点击获取修改数据的值
    $(document).on("click", ".revise", function () {
        var roleNo = $(this).parent().parent().children(":eq(0)").text();
        var put = $(this).parent().parent().children(":eq(1)").text();
        var der = $(this).parent().parent().children(":eq(2)").text();
        var ders = $(this).parent().parent().children(":eq(3)").text();
        window.location.href = "roleManchild.html?id=" + roleNo + "&put=" + put + "&der=" + der + "&ders=" + ders;
    })

    //删除角色信息
    $(document).on("click", ".del", function () {
        if (confirm("确认删除吗?")) {
            $(this).parent().parent().remove();
            var put = $(this).parent().parent().children(":eq(0)").text();
            var request = new XMLHttpRequest();
            request.open("get", "deleterole.do?put=" + put, true);
            request.send(null);
        }
    });
    //查询信息
    $(".Search").click(function () {       //给查询按钮设置单击事件
        var num = $("#perNo").val(),
            name = $("#perName").val();
        var request = new XMLHttpRequest();
        request.open("get", "seach.do?roleNo=" + num + "&&roleName=" + name);
        request.onreadystatechange = function () {
            if (request.readyState == 4 && request.status == 200) {
                var data = JSON.parse(request.responseText);
                arr(data);
            }
        };
        request.send(null);
    });

</script>

<!--<script type="text/javascript">
var classArr=window.top.classArr;
var classCourseArr=window.top.classCourseArr;
var studentArr=window.top.studentArr;
//添加默认数据


/*for(var i=0;i<classArr.length;i++){
    var count=0;
    for(var j=0;j<studentArr.length;j++){
        if (classArr[i].classNo==studentArr[j].classNo){
            count++;
        }
    }
   str='<tr>'+
           '<td class="classDate" >'+classArr[i].classNo+'</td>'+
           '<td class="classDate">'+classArr[i].className+'</td>'+
           '<td class="classDate">'+classArr[i].classRoom+'</td>'+
           '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
           '<td class="classDate">'+count+'</td>'+
           '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
           '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
           '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
           '<td class="classDate">'+classArr[i].classBz+'</td>'+
           '<td class="classDate">'+classArr[i].creater+'</td>'+
           '<td class="classDate">'+classArr[i].createTime+'</td>'+
           '<td class="classDate"><button class="Ope">修改</button></td>'+
           '</tr>';
   $("tbody").append(str);
}*/
//查询
$(".Search").click(function () {
    var Nos=$(".claNo").val();
    var Nas=$(".claName").val();
    var pms=$(".proMan").val();
    var tea=$(".claTea").val();
    $("tbody").html("");
    var count=0;
for(i=0;i<classArr.length;i++){
    var count1=0;
    for(var j=0;j<studentArr.length;j++){
        if (classArr[i].classNo==studentArr[j].classNo){
            count1++;
        }
    }
    if(Nas==classArr[i].className&&Nos==""&&pms==""&&tea==""){
        str='<tr>'+
            '<td class="classDate">'+classArr[i].classNo+'</td>'+
            '<td class="classDate">'+classArr[i].className+'</td>'+
            '<td class="classDate">'+classArr[i].classRoom+'</td>'+
            '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
            '<td class="classDate">'+count1+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
            '<td class="classDate">'+classArr[i].classBz+'</td>'+
            '<td class="classDate">'+classArr[i].creater+'</td>'+
            '<td class="classDate">'+classArr[i].createTime+'</td>'+
            '<td class="classDate"><button class="Ope">修改</button></td>'+
            '</tr>';
        $("tbody").append(str);
    }else if(Nos==classArr[i].classNo&&Nas==""&&pms==""&&tea==""){
        str='<tr>'+
            '<td class="classDate">'+classArr[i].classNo+'</td>'+
            '<td class="classDate">'+classArr[i].className+'</td>'+
            '<td class="classDate">'+classArr[i].classRoom+'</td>'+
            '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
            '<td class="classDate">'+count1+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
            '<td class="classDate">'+classArr[i].classBz+'</td>'+
            '<td class="classDate">'+classArr[i].creater+'</td>'+
            '<td class="classDate">'+classArr[i].createTime+'</td>'+
            '<td class="classDate"><button class="Ope">修改</button></td>'+
            '</tr>';
        $("tbody").append(str);
    }else if(pms==classCourseArr[0][i].peopleName&&Nas==""&&Nos==""&&tea==""){
        str='<tr>'+
            '<td class="classDate">'+classArr[i].classNo+'</td>'+
            '<td class="classDate">'+classArr[i].className+'</td>'+
            '<td class="classDate">'+classArr[i].classRoom+'</td>'+
            '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
            '<td class="classDate">'+count1+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
            '<td class="classDate">'+classArr[i].classBz+'</td>'+
            '<td class="classDate">'+classArr[i].creater+'</td>'+
            '<td class="classDate">'+classArr[i].createTime+'</td>'+
            '<td class="classDate"><button class="Ope">修改</button></td>'+
            '</tr>';
        $("tbody").append(str);
    }else if(tea==classCourseArr[0][i].peopleName&&Nas==""&&pms==""&&Nos==""){
        str='<tr>'+
            '<td class="classDate">'+classArr[i].classNo+'</td>'+
            '<td class="classDate">'+classArr[i].className+'</td>'+
            '<td class="classDate">'+classArr[i].classRoom+'</td>'+
            '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
            '<td class="classDate">'+count1+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
            '<td class="classDate">'+classArr[i].classBz+'</td>'+
            '<td class="classDate">'+classArr[i].creater+'</td>'+
            '<td class="classDate">'+classArr[i].createTime+'</td>'+
            '<td class="classDate"><button class="Ope">修改</button></td>'+
            '</tr>';
        $("tbody").append(str);
    }else if(Nas==classArr[i].className&&Nos==classArr[i].classNo){
        str='<tr>'+
            '<td class="classDate">'+classArr[i].classNo+'</td>'+
            '<td class="classDate">'+classArr[i].className+'</td>'+
            '<td class="classDate">'+classArr[i].classRoom+'</td>'+
            '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
            '<td class="classDate">'+count1+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
            '<td class="classDate">'+classArr[i].classBz+'</td>'+
            '<td class="classDate">'+classArr[i].creater+'</td>'+
            '<td class="classDate">'+classArr[i].createTime+'</td>'+
            '<td class="classDate"><button class="Ope">修改</button></td>'+
            '</tr>';
        $("tbody").append(str);
    }else if(Nos==classArr[i].classNo&&Nas==classArr[i].className&&pms==classCourseArr[0][i].peopleName&&tea==classCourseArr[0][1].peopleName){
        str='<tr>'+
            '<td class="classDate" align="center">'+classArr[i].classNo+'</td>'+
            '<td class="classDate">'+classArr[i].className+'</td>'+
            '<td class="classDate">'+classArr[i].classRoom+'</td>'+
            '<td class="classDate">'+classArr[i].classStartDay+'</td>'+
            '<td class="classDate">'+count1+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].peopleName+'</td>'+
            '<td class="classDate">'+classCourseArr[0][i].stageName+'</td>'+
            '<td class="classDate">'+classArr[i].classBz+'</td>'+
            '<td class="classDate">'+classArr[i].creater+'</td>'+
            '<td class="classDate">'+classArr[i].createTime+'</td>'+
            '<td class="classDate"><button class="Ope">修改</button></td>'+
            '</tr>';
        $("tbody").append(str);
    }else{
        count++;
        if(count==classArr.length){
        alert("没有找到此班级信息")
        }
    }
}
});
    $(document).on("click",".Ope",(function () {
        var bhs=$(this).parent().parent().children(":eq(0)").text();
        var name=$(this).parent().parent().children(":eq(1)").text();
        var classMate=$(this).parent().parent().children(":eq(2)").text();
        var startData=$(this).parent().parent().children(":eq(3)").text();
        var pelNun=$(this).parent().parent().children(":eq(4)").text();
        var xmjl=$(this).parent().parent().children(":eq(5)").text();
        var bzr=$(this).parent().parent().children(":eq(6)").text();
        var jieduan=$(this).parent().parent().children(":eq(7)").text();
        var beizhu=$(this).parent().parent().children(":eq(8)").text();
        window.location.href="classXz.html?claNo="+bhs+"&name="+name+"&classMate="+classMate+"" +
            "&startData="+startData+"&pelNum="+pelNun+"&xmjl="+xmjl+"&bzr="+bzr+"" +
            "&jieduan="+jieduan+"&beizhu="+beizhu;
    }))

</script>-->
</body>
</html>